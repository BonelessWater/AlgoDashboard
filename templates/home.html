{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h3 class="center-align">Portfolio Dashboard</h3>

    <div class="row">
        <!-- Current Allocation Chart -->
        <div class="col s12 m6">
            <div class="card">
                <div class="card-content">
                    <span class="card-title">Current Allocation</span>
                    <canvas id="currentAllocationChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Recommended Allocation Chart -->
        <div class="col s12 m6">
            <div class="card">
                <div class="card-content">
                    <span class="card-title">Recommended Allocation</span>
                    <canvas id="recommendedAllocationChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Risk Metrics Chart -->
        <div class="col s12 m6">
            <div class="card">
                <div class="card-content">
                    <span class="card-title">Risk Metrics Over Time</span>
                    <canvas id="riskMetricsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Performance Over Time Chart -->
        <div class="col s12 m6">
            <div class="card">
                <div class="card-content">
                    <span class="card-title">Performance Over Time</span>
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Chart.js library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Mock data for current allocation
    const currentAllocationData = {
        labels: ['Stocks', 'Bonds', 'Real Estate', 'Commodities', 'Cash'],
        datasets: [{
            data: [35, 30, 20, 10, 5],
            backgroundColor: ['#1e88e5', '#43a047', '#fb8c00', '#f4511e', '#6d4c41']
        }]
    };

    // Mock data for recommended allocation
    const recommendedAllocationData = {
        labels: ['Stocks', 'Bonds', 'Real Estate', 'Commodities', 'Cash'],
        datasets: [{
            data: [40, 25, 15, 15, 5],
            backgroundColor: ['#1e88e5', '#43a047', '#fb8c00', '#f4511e', '#6d4c41']
        }]
    };

    // Configurations for allocation pie charts
    const allocationConfig = {
        type: 'pie',
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top'
                }
            }
        }
    };

    // Render Current Allocation Chart
    new Chart(document.getElementById('currentAllocationChart'), {
        ...allocationConfig,
        data: currentAllocationData
    });

    // Render Recommended Allocation Chart
    new Chart(document.getElementById('recommendedAllocationChart'), {
        ...allocationConfig,
        data: recommendedAllocationData
    });

    // Mock data for risk metrics over time
    const riskMetricsData = {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [
            {
                label: 'VaR',
                data: [5, 6, 5.5, 7, 6.5, 7, 8, 7.5, 6.8, 7.2, 7.6, 6.9],
                borderColor: '#e53935',
                fill: false,
                tension: 0.4
            },
            {
                label: 'CVaR',
                data: [8, 8.5, 8.2, 9, 9.1, 9.3, 10, 9.7, 8.9, 9.2, 9.6, 9],
                borderColor: '#fb8c00',
                fill: false,
                tension: 0.4
            }
        ]
    };

    // Config for risk metrics chart
    const riskConfig = {
        type: 'line',
        data: riskMetricsData,
        options: {
            responsive: true,
            scales: {
                x: {
                    title: { display: true, text: 'Month' }
                },
                y: {
                    title: { display: true, text: 'Percentage (%)' },
                    beginAtZero: true
                }
            },
            plugins: { legend: { position: 'top' } }
        }
    };

    // Render Risk Metrics Chart
    new Chart(document.getElementById('riskMetricsChart'), riskConfig);

    // Mock data for performance over time
    const performanceData = {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [{
            label: 'Portfolio Value ($)',
            data: [100000, 102000, 104500, 107000, 109500, 111000, 115000, 117000, 118500, 120000, 121500, 123000],
            borderColor: '#1e88e5',
            fill: false,
            tension: 0.4
        }]
    };

    // Config for performance chart
    const performanceConfig = {
        type: 'line',
        data: performanceData,
        options: {
            responsive: true,
            scales: {
                x: {
                    title: { display: true, text: 'Month' }
                },
                y: {
                    title: { display: true, text: 'Portfolio Value ($)' },
                    beginAtZero: false
                }
            },
            plugins: { legend: { position: 'top' } }
        }
    };

    // Render Performance Chart
    new Chart(document.getElementById('performanceChart'), performanceConfig);
</script>
{% endblock %}
